<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title> grid </title>
  <style type="text/css">
   
  </style>
 </head>

 <body>
 <div id="fps">0</div>
   <canvas id="canvas" width="800" height="600"></canvas>
   <script type="application/x-javascript">
        var ctx = document.getElementById('canvas').getContext('2d');
      draw();

      function draw() {
       
        ctx.fillStyle = "#EEE";
        ctx.fillRect(0,0,800,600);

        var w=80,h=80,ax=w/4,ay=h/4;
        //ctx.translate(100,100);//=====================position 100,100
        for(var i=0;i<100;i++){
        ctx.save();
        ctx.fillStyle = "#E00";
        ctx.translate(50,50);
        ctx.fillRect(0,0,100,100);
        ctx.restore();
        
        ctx.save();
        ctx.fillStyle = "#0E0";
        ctx.beginPath();
        ctx.moveTo(100,100);
        //ctx.lineTo(150,100);
        ctx.arc(150,120,20,-Math.PI/2,0);
        ctx.lineTo(170,150);
        ctx.arc(150,150,20,0,Math.PI/2,false);
        ctx.lineTo(100,170);
        ctx.lineTo(100,100);
        ctx.stroke();
//        ctx.globalCompositeOperation="copy";
//        ellipse(ctx,[100,100],50,30);
        ctx.restore();
        
        ctx.save();
        ctx.lineWidth=20;
        ctx.beginPath();
        ctx.arc(300,300,200,-Math.PI*2,0);
        ctx.stroke();
        ctx.restore();

        ctx.save();
        ctx.translate(100,100);
        ctx.fillStyle = "#0E0";
        ctx.beginPath();
        ctx.moveTo(100,100);
        //ctx.lineTo(150,100);
        ctx.arc(150,120,20,-Math.PI/2,0);
        ctx.lineTo(170,150);
        ctx.arc(150,150,20,0,Math.PI/2,false);
        ctx.lineTo(100,170);
        ctx.lineTo(100,100);
        
        
        ctx.stroke();
        //ctx.fill();
        ctx.restore();

        ctx.save();
        ctx.translate(50,50);
        ctx.fillStyle = "#0E0";
        ctx.beginPath();
        ctx.moveTo(100,100);
        ctx.lineTo(150,100);
        ctx.arc(150,120,20,-Math.PI/2,0);
        ctx.lineTo(170,150);
        ctx.arc(150,150,20,0,Math.PI/2);
        ctx.lineTo(100,170);
        //ctx.lineTo(100,100);
        ctx.stroke();
        ctx.restore();
     
      }

      }
      var n=0,m=0;
      setInterval(function  () {
            draw();
            m++;
      },1000/60);  

        var fps=document.getElementById("fps");
        setInterval(function  () {
            fps.innerHTML=m-n;
            n=m;
        },1000);

      function rect(ctx,strokeStyle,translate,rotate,afterTranslate){
        ctx.save();
        ctx.strokeStyle =strokeStyle;
        ctx.translate(translate[0],translate[1]);
        ctx.rotate(rotate*Math.PI/180);
        afterTranslate && ctx.translate(afterTranslate[0],afterTranslate[1]);
        ctx.restore();
      }
      function ellipsePath(ctx,x,y,a,b){
            var aa=a*0.5522847498307933984022516322796,
                bb=b*0.5522847498307933984022516322796;
            ctx.beginPath();
            ctx.moveTo(x,y+b);
            ctx.bezierCurveTo(x+aa,y+b,   x+a,y+bb,    x+a,y);
            ctx.bezierCurveTo(x+a,y-bb,   x+aa,y-b,    x,y-b);
            ctx.bezierCurveTo(x-aa,y-b,   x-a,y-bb,    x-a,y);
            ctx.bezierCurveTo(x-a,y+bb,   x-aa,y+b,    x,y+b);
            //ctx.fill();
            ctx.stroke();
      }

      function ellipse(ctx,O,OA,OB){
        //画椭圆，例子：var B=new Array(150,150); DrawEllipse(hb,B,50,30);
        var x=O[0]+OA;
        var y=O[1];
        ctx.beginPath();
        ctx.moveTo(x,y);
        for (var i=0;i<=360;i++){
            var ii=i*Math.PI/180;
            var x=O[0]+OA*Math.cos(ii);
            var y=O[1]-OB*Math.sin(ii);
            ctx.lineTo(x,y);
        }
        ctx.stroke();
      }
      function ellipse3(ctx,x,y,a,b) {
        var aa=a*0.5522847498307933984022516322796,
            bb=b*0.5522847498307933984022516322796;
        ctx.beginPath();
        ctx.moveTo(x,y+b);
        ctx.bezierCurveTo(x+aa,y+b,   x+a,y+bb,    x+a,y);
        ctx.bezierCurveTo(x+a,y-bb,   x+aa,y-b,    x,y-b);
        ctx.bezierCurveTo(x-aa,y-b,   x-a,y-bb,    x-a,y);
        ctx.bezierCurveTo(x-a,y+bb,   x-aa,y+b,    x,y+b);
        //ctx.fill();
        ctx.stroke();
      } 
      function ellipse2(ctx,x,y,a,b) {
        var aa=a*0.5522847498307933984022516322796,
            bb=b*0.5522847498307933984022516322796,
            xa=x+a,
            yb=y+b,
            xaa=x+aa
            ybb=y+bb;
        ctx.beginPath();
        ctx.moveTo(x,y+b);
        ctx.bezierCurveTo(xaa,yb,   xa,ybb,    xa,y);
        ctx.bezierCurveTo(xa,y-bb,   xaa,y-b,    x,y-b);
        ctx.bezierCurveTo(x-aa,y-b,   x-a,y-bb,    x-a,y);
        ctx.bezierCurveTo(x-a,ybb,   x-aa,y+b,    x,y+b);
        //ctx.fill();
        ctx.stroke();
      } 
    </script>
 </body>
</html>